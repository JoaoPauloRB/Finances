@page "/account"
@using Web.Features.Accounts
@using Web.Components.AccountCard
@using Domain.Models
@inject HttpClient Http

@inherits BlazorStateComponent

<h1>Contas</h1>

<div class="new-account-form-wrapper">
  <div class="form-group">
    <label for="description">Descrição</label>
    <input type="text" class="form-control" id="description" @bind="@account.Description">
  </div>
  <div class="form-group">
    <label for="balance">Saldo</label>
    <input type="text" class="form-control" id="balance" @bind="@account.Balance">
  </div>
  <button class="btn btn-primary" @onclick="AddAccount">Adicionar</button>
</div>


<div class="list-accounts-wrapper">
  @foreach (var acc in State.accounts)
  {
    <AccountCard
      Description="@acc.Description"
      Balance="@acc.Balance"
      Currency="0"/>
  }
</div>

@code {
  AccountState State => GetState<AccountState>();
  private Account account = new Account();
  private async void AddAccount()
  {    
    await Mediator.Send(new AccountState.AddAccountAction(account));
    StateHasChanged();
  }
  protected override async Task OnInitializedAsync()
  {
    await Mediator.Send(new AccountState.ListAccountsAction());
  }
}
